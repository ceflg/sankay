import plotly.graph_objects as go


label = [
    # First ROW A labels
    "A0",
    "A1",
    "A2",
    "A3",
    "A4",
    "A5",
    "A6",
    "A7",
    # Second ROW B labels
    "B0",
    "B1",
    "B2",
    "B3",
    "B4",
    "B5",
    "B6",
    "B7",
    # Thirdth ROW C labels
    "C0",
    "C1",
    "C2",
    "C3",
    "C4",
    "C5",
    "C6",
    "C7",
    # Fourth ROW D labels
    "D0",
    "D1",
    "D2",
    "D3",
    "D4",
    "D5",
    "D6",
    "D7",   # 28
    # Fifth ROW E labels
    "E0",
    "E1",
    "E2",
    "E3",
    "E4",
    "E5",
    "E6",
    "E7",
]
# node colours
color_node = [
    # LEVEL A
    '#808B96', '#808B96', '#808B96', '#808B96',
    '#808B96', '#808B96', '#808B96', '#808B96',
    # LEVEL B
    '#808B00', '#808B00', '#808B00', '#808B00',
    '#808B00', '#808B00', '#808B00', '#808B00',
    # LEVEL C
    '#AF7AC5', '#AF7AC5', '#AF7AC5', '#AF7AC5',
    '#AF7AC5', '#AF7AC5', '#AF7AC5', '#AF7AC5',
    # LEVEL D
    '#48C9B0', '#48C9B0', '#48C9B0', '#48C9B0',
    '#48C9B0', '#48C9B0', '#48C9B0', '#48C9B0'
    # LEVEL E
    # not specified => black colour
]
color_link = [
    # LEVEL A
    # LINKS
    # link 1     link 2     link3      link 4     link 5     link 6     link 7     link 8    # ROWS
    '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665',  # A0
    '#ADD8E6', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665',  # A1
    '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665',  # A2
    '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665',
    '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665',
    '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665',
    '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665',
    '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665',
    # LEVEL B
    '#696665', '#ADD8E6', '#ADD8E6', '#ADD8E6', '#696665', '#696665', '#696665', '#696665',  # B0
    '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665',  # B1
    '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665',  # B2
    '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665',
    '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665',
    '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665',
    '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665',
    '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665',
    # LEVEL C
    '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665',  # C0
    '#ADD8E6', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665',  # C1
    '#ADD8E6', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665',  # C2
    '#ADD8E6', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665',
    '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665',
    '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665',
    '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665',
    '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665',
    # LEVEL D to E
    '#696665', '#ADD8E6', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665',  # D0
    '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665',  # D1
    '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665',  # D2
    '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665',
    '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665',
    '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665',
    '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665',
    '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665', '#696665',
]
source = [
    # Every node have 8 source links
    # LEVEL A
    0, 0, 0, 0, 0, 0, 0, 0,
    1, 1, 1, 1, 1, 1, 1, 1,
    2, 2, 2, 2, 2, 2, 2, 2,
    3, 3, 3, 3, 3, 3, 3, 3,
    4, 4, 4, 4, 4, 4, 4, 4,
    5, 5, 5, 5, 5, 5, 5, 5,
    6, 6, 6, 6, 6, 6, 6, 6,
    # LEVEL B
    7, 7, 7, 7, 7, 7, 7, 7,
    8, 8, 8, 8, 8, 8, 8, 8,
    9, 9, 9, 9, 9, 9, 9, 9,
    10, 10, 10, 10, 10, 10, 10, 10,
    11, 11, 11, 11, 11, 11, 11, 11,
    12, 12, 12, 12, 12, 12, 12, 12,
    # LEVEL C
    13, 13, 13, 13, 13, 13, 13, 13,
    14, 14, 14, 14, 14, 14, 14, 14,
    15, 15, 15, 15, 15, 15, 15, 15,
    16, 16, 16, 16, 16, 16, 16, 16,
    17, 17, 17, 17, 17, 17, 17, 17,
    18, 18, 18, 18, 18, 18, 18, 18,
    19, 19, 19, 19, 19, 19, 19, 19,
    20, 20, 20, 20, 20, 20, 20, 20,
    # LEVEL D
    21, 21, 21, 21, 21, 21, 21, 21,
    22, 22, 22, 22, 22, 22, 22, 22,
    23, 23, 23, 23, 23, 23, 23, 23,
    24, 24, 24, 24, 24, 24, 24, 24,
    25, 25, 25, 25, 25, 25, 25, 25,
    26, 26, 26, 26, 26, 26, 26, 26,
    27, 27, 27, 27, 27, 27, 27, 27,
    # LEVEL E
    28, 28, 28, 28, 28, 28, 28, 28,
    29, 29, 29, 29, 29, 29, 29, 29,
    30, 30, 30, 30, 30, 30, 30, 30,
    31, 31, 31, 31, 31, 31, 31, 31,
    32, 32, 32, 32, 32, 32, 32, 32,
    33, 33, 33, 33, 33, 33, 33, 33,
    34, 34, 34, 34, 34, 34, 34, 34,
    35, 35, 35, 35, 35, 35, 35, 35,
    36, 36, 36, 36, 36, 36, 36, 36,
    37, 37, 37, 37, 37, 37, 37, 37,
    38, 38, 38, 38, 38, 38, 38, 38
]
target = [
    # From source A0-A7 to targets B0-B7, e.g 8 pcd line from A0 to B1,B2,B3,B4,B5,B6,B7 etc.
    # LEVEL A lines to B0 - B7
    8, 9, 10, 11, 12, 13, 14, 15,
    8, 9, 10, 11, 12, 13, 14, 15,
    8, 9, 10, 11, 12, 13, 14, 15,
    8, 9, 10, 11, 12, 13, 14, 15,
    8, 9, 10, 11, 12, 13, 14, 15,
    8, 9, 10, 11, 12, 13, 14, 15,
    8, 9, 10, 11, 12, 13, 14, 15,
    8, 9, 10, 11, 12, 13, 14, 15,
    # LEVEL B lines to C0 - C7
    16, 17, 18, 19, 20, 21, 22, 23,
    16, 17, 18, 19, 20, 21, 22, 23,
    16, 17, 18, 19, 20, 21, 22, 23,
    16, 17, 18, 19, 20, 21, 22, 23,
    16, 17, 18, 19, 20, 21, 22, 23,
    16, 17, 18, 19, 20, 21, 22, 23,
    16, 17, 18, 19, 20, 21, 22, 23,
    16, 17, 18, 19, 20, 21, 22, 23,
    # LEVEL C lines to D0 - D7
    24, 25, 26, 27, 28, 29, 30, 31,
    24, 25, 26, 27, 28, 29, 30, 31,
    24, 25, 26, 27, 28, 29, 30, 31,
    24, 25, 26, 27, 28, 29, 30, 31,
    24, 25, 26, 27, 28, 29, 30, 31,
    24, 25, 26, 27, 28, 29, 30, 31,
    24, 25, 26, 27, 28, 29, 30, 31,
    24, 25, 26, 27, 28, 29, 30, 31,
    # LEVEL D lines to E0 - E7
    32, 33, 34, 35, 36, 37, 38, 39,
    32, 33, 34, 35, 36, 37, 38, 39,
    32, 33, 34, 35, 36, 37, 38, 39,
    32, 33, 34, 35, 36, 37, 38, 39,
    32, 33, 34, 35, 36, 37, 38, 39,
    32, 33, 34, 35, 36, 37, 38, 39,
    32, 33, 34, 35, 36, 37, 38, 39,
    32, 33, 34, 35, 36, 37, 38, 39
]
value = [
    # Level A => B
    1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1,
    # Level B = > C
    1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1,
    # Level C = > D
    1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1,
    # Level D = > E
    1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1,
]

# data to dict, dict to sankey
link = dict(source=source, target=target, value=value, color=color_link)
node = dict(label=label, pad=25, thickness=5, color=color_node)
data = go.Sankey(link=link, node=node, arrangement='freeform')

# plot
fig = go.Figure(data)
# Row titles
for x_coordinate, column_name in enumerate(["TITLE 1", "TITLE 2 ", "TITLE 3", "TITLE 4", "TITLE 5"]):
    fig.add_annotation(
        x=x_coordinate,
        y=1.05,
        xref="x",
        yref="paper",
        text=column_name,
        showarrow=False,
        font=dict(
            size=10,
            color="white"
        ),
        align="center",
    )
fig.update_layout(
    hovermode='x',
    title_text=" SANKEY example matrix",
    paper_bgcolor='#5B5958',
    font=dict(size=12, color='white'),
    xaxis={
        'showgrid': False,  # thin lines in the background
        'zeroline': False,  # thick line at x=0
        'visible': False,  # numbers below
    },
    yaxis={
        'showgrid': False,  # thin lines in the background
        'zeroline': False,  # thick line at x=0
        'visible': False,  # numbers below
    },
    plot_bgcolor='rgba(0,0,0,0)',
    font_size=12)

fig.show()
